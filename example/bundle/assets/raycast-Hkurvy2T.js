import{M as C,i as D,k as W,e as O,l as j,W as G,c as N,d as I,D as k,A as K,O as L,T as q,m as J,P as Q,V as b,f as F}from"./ExtendedTriangle-hsPasuNU.js";/* empty css               */import{S as U}from"./stats.min-DbzWzcqd.js";import{g as X}from"./lil-gui.module.min-BH_YJbPT.js";import{C as V,A as Y,S as Z}from"./MeshBVH-DQV6PBDm.js";import{a as _,c as $,d as ee}from"./ExtensionUtilities-BlnM4xb7.js";import{B as te}from"./BVHHelper-DA_xcAFF.js";import"./_commonjsHelpers-CqkleIqs.js";C.prototype.raycast=_;D.prototype.computeBoundsTree=$;D.prototype.disposeBoundsTree=ee;const v=1250841,f=25,e={raycasterCount:150,raycasterSpeed:1,raycasterNear:0,raycasterFar:f,splitStrategy:V,meshCount:1,meshSpeed:1,useBoundsTree:!0,displayBVH:!1,displayDepth:10,displayParents:!1};let u,g,B,M,c,R,n,r;const l=[],x=[],p=new W;p.firstHitOnly=!0;const z=new O(.25,20,20),ne=new j(.01,.01);let T=null;ae();y();function ae(){u=new G({antialias:!0}),u.setPixelRatio(window.devicePixelRatio),u.setSize(window.innerWidth,window.innerHeight),u.setClearColor(v,1),u.setAnimationLoop(se),document.body.appendChild(u.domElement),g=new N,g.fog=new I(v,40,80);const t=new k(16777215,.5);t.position.set(1,1,1);const s=new K(16777215,.4);g.add(t,s);const a=1,h=.4,m=400,w=100;r=new L,c=new q(a,h,m,w),R=new J({color:15277667}),r.scale.setScalar(10),r.rotation.x=r.rotation.y=10.989999999999943,g.add(r),M=new Q(75,window.innerWidth/window.innerHeight,.1,100),M.position.z=60,B=new U,document.body.appendChild(B.dom);const d=new X,o=d.addFolder("Raycasters");o.add(e,"raycasterCount",1,1e3,1).onChange(y),o.add(e,"raycasterSpeed",0,20),o.add(e,"raycasterNear",0,f).onChange(y),o.add(e,"raycasterFar",0,f).onChange(y),o.open();const i=d.addFolder("Mesh");i.add(e,"useBoundsTree").onChange(y),i.add(e,"splitStrategy",{CENTER:V,SAH:Z,AVERAGE:Y}).onChange(y),i.add(e,"meshCount",1,300,1).onChange(y),i.add(e,"meshSpeed",0,20),i.add(e,"displayBVH").onChange(y),i.add(e,"displayParents").onChange(S=>{n&&(n.displayParents=S,n.update())}),i.add(e,"displayDepth",1,20,1).onChange(S=>{n&&(n.depth=S,n.update())}),i.open(),window.addEventListener("resize",()=>{M.aspect=window.innerWidth/window.innerHeight,M.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight)})}function oe(){const t=new C(c,R);t.rotation.x=Math.random()*10,t.rotation.y=Math.random()*10,l.push(t),r.add(t)}function re(){const t=new L,s=new F({color:16777215}),a=new C(z,s),h=new C(z,s);h.scale.setScalar(.25),a.scale.setScalar(.5);const m=new C(ne,new F({color:16777215,transparent:!0,opacity:.25}));m.rotation.z=Math.PI/2,t.add(m,a,h),g.add(t),a.position.set(f,0,0),t.rotation.x=Math.random()*10,t.rotation.y=Math.random()*10,t.rotation.z=Math.random()*10;const w=new b,d=new b,o=Math.random()-.5,i=Math.random()-.5,S=Math.random()-.5;x.push({update:H=>{t.rotation.x+=o*1e-4*e.raycasterSpeed*H,t.rotation.y+=i*1e-4*e.raycasterSpeed*H,t.rotation.z+=S*1e-4*e.raycasterSpeed*H,a.updateMatrixWorld(),w.setFromMatrixPosition(a.matrixWorld),d.copy(w).multiplyScalar(-1).normalize(),p.set(w,d);const P=p.intersectObject(r,!0),A=P.length?P[0].distance:f;h.position.set(f-A,0,0);const E=P.length?A-p.near:A-p.near-(f-p.far);m.position.set(f-p.near-E/2,0,0),m.scale.set(1,E,1)},remove:()=>g.remove(t)})}function y(){for(p.near=e.raycasterNear,p.far=e.raycasterFar;x.length>e.raycasterCount;)x.pop().remove();for(;x.length<e.raycasterCount;)re();if(!c)return;(!e.useBoundsTree&&c.boundsTree||c.boundsTree&&e.splitStrategy!==c.boundsTree.splitStrategy)&&c.disposeBoundsTree(),e.useBoundsTree&&!c.boundsTree&&(console.time("computing bounds tree"),c.computeBoundsTree({maxLeafSize:5,strategy:parseFloat(e.splitStrategy)}),c.boundsTree.splitStrategy=e.splitStrategy,console.timeEnd("computing bounds tree"),n&&n.update());const t=l.length;for(;l.length>e.meshCount;)r.remove(l.pop());for(;l.length<e.meshCount;)oe();if(t!==l.length){const a=(d,o,i)=>d+(o-d)*i,h=(l.length-1)/299,m=a(0,2,h),w=a(1,.2,h);l.forEach(d=>{d.scale.setScalar(w);const o=new b(0,1,0);o.applyAxisAngle(new b(1,0,0),Math.PI*Math.random()),o.applyAxisAngle(new b(0,1,0),2*Math.PI*Math.random()),o.multiplyScalar(m),d.position.copy(o)})}const s=e.displayBVH&&c.boundsTree;n&&!s&&(r.remove(n),n=null),!n&&s&&(n=new te(l[0]),r.add(n))}function se(){B.begin();const t=window.performance.now();T=T||t;const s=t-T;n&&(n.visible=e.displayBVH),r.rotation.x+=1e-4*e.meshSpeed*s,r.rotation.y+=1e-4*e.meshSpeed*s,r.children.forEach(a=>{a.rotation.x+=1e-4*e.meshSpeed*s,a.rotation.y+=1e-4*e.meshSpeed*s}),r.updateMatrixWorld(),x.forEach(a=>a.update(s)),u.render(g,M),T=t,B.end()}
//# sourceMappingURL=raycast-Hkurvy2T.js.map
