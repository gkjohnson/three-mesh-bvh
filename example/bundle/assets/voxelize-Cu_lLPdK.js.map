{"version":3,"file":"voxelize-Cu_lLPdK.js","sources":["../../voxelize.js"],"sourcesContent":["import * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { MeshoptDecoder } from 'three/examples/jsm/libs/meshopt_decoder.module.js';\nimport Stats from 'stats.js';\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min.js';\nimport { MeshBVH } from 'three-mesh-bvh';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { RoundedBoxGeometry } from 'three/examples/jsm/geometries/RoundedBoxGeometry.js';\nimport { GenerateMeshBVHWorker } from 'three-mesh-bvh/worker';\n\nlet renderer, camera, scene, gui, stats, outputContainer;\nlet voxels, controls, boxHelper;\nlet needsUpdate = false;\nlet voxelTask = null;\n\nconst params = {\n\tmodel: 'Torus Knot',\n\tscale: 0.75,\n\tresolution: 30,\n\tsolid: true,\n\tdisplayMesh: true,\n\tdisplayBounds: false,\n\tinsideOnly: false,\n\trebuild: () => needsUpdate = true,\n};\n\nconst models = {};\n\ninit();\n\nfunction init() {\n\n\tconst bgColor = 0x161e1d;\n\n\toutputContainer = document.getElementById( 'output' );\n\n\t// renderer setup\n\trenderer = new THREE.WebGLRenderer( { antialias: true } );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.setClearColor( bgColor, 1 );\n\trenderer.setAnimationLoop( render );\n\trenderer.outputEncoding = THREE.sRGBEncoding;\n\tdocument.body.appendChild( renderer.domElement );\n\n\t// scene setup\n\tscene = new THREE.Scene();\n\n\tconst light = new THREE.DirectionalLight( 0xffffff, 3 );\n\tlight.position.set( 3, 6, 9 );\n\tscene.add( light );\n\n\tconst revLight = new THREE.DirectionalLight( 0xffffff, 0.3 );\n\trevLight.position.set( - 3, - 6, - 9 );\n\tscene.add( revLight );\n\n\tconst ambient = new THREE.AmbientLight( 0xffffff, 0.75 );\n\tscene.add( ambient );\n\n\t// camera setup\n\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 50 );\n\tcamera.position.set( 1, 0.5, 1 );\n\tcamera.far = 100;\n\tcamera.updateProjectionMatrix();\n\n\tcontrols = new OrbitControls( camera, renderer.domElement );\n\n\t// stats setup\n\tstats = new Stats();\n\tdocument.body.appendChild( stats.dom );\n\n\tconst wireframeMaterial = new THREE.MeshBasicMaterial( {\n\n\t\ttransparent: true,\n\t\twireframe: true,\n\t\tdepthWrite: false,\n\t\topacity: 0.02,\n\n\t} );\n\n\t// load the model\n\tnew GLTFLoader()\n\t\t.setMeshoptDecoder( MeshoptDecoder )\n\t\t.load( 'https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/happy-buddha/buddha.glb', gltf => {\n\n\t\t\tconst model = gltf.scene.children[ 0 ];\n\t\t\tmodel.geometry.center();\n\t\t\tmodel.material = wireframeMaterial;\n\t\t\tmodel.scale.setScalar( 1.5 );\n\t\t\tmodel.rotation.y = - Math.PI / 2;\n\n\t\t\tconst generator = new GenerateMeshBVHWorker();\n\t\t\tgenerator.generate( model.geometry ).then( bvh => {\n\n\t\t\t\tscene.add( model );\n\t\t\t\tmodels[ 'Buddha' ] = { model, bvh };\n\t\t\t\tif ( params.model === 'Buddha' ) {\n\n\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\tnew GLTFLoader()\n\t\t.setMeshoptDecoder( MeshoptDecoder )\n\t\t.load( 'https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/stanford-bunny/bunny.glb', gltf => {\n\n\t\t\tconst model = gltf.scene.children[ 0 ];\n\t\t\tmodel.geometry.center();\n\t\t\tmodel.material = wireframeMaterial;\n\t\t\tmodel.rotation.y = Math.PI / 2;\n\t\t\tmodel.scale.setScalar( 0.65 );\n\n\t\t\tconst generator = new GenerateMeshBVHWorker();\n\t\t\tgenerator.generate( model.geometry ).then( bvh => {\n\n\t\t\t\tscene.add( model );\n\t\t\t\tmodels[ 'Bunny' ] = { model, bvh };\n\t\t\t\tif ( params.model === 'Bunny' ) {\n\n\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t{\n\n\t\tconst model = new THREE.Mesh( new THREE.TorusKnotGeometry( 0.3, 0.1, 400, 60 ), wireframeMaterial );\n\t\tconst bvh = new MeshBVH( model.geometry );\n\t\tscene.add( model );\n\n\t\tmodels[ 'Torus Knot' ] = {\n\t\t\tbvh: bvh,\n\t\t\tmodel: model,\n\t\t};\n\t\tneedsUpdate = true;\n\n\t}\n\n\tmodels[ 'Buddha' ] = { model: null, bvh: null };\n\tmodels[ 'Bunny' ] = { model: null, bvh: null };\n\n\tconst boxHelperMesh = new THREE.Mesh( new THREE.BoxGeometry() );\n\tboxHelper = new THREE.BoxHelper( boxHelperMesh, 0xffffff );\n\tboxHelper.material.opacity = 0.35;\n\tboxHelper.material.transparent = true;\n\tscene.add( boxHelper );\n\n\tgui = new GUI();\n\tgui.add( params, 'model', Object.keys( models ) ).onChange( () => {\n\n\t\tneedsUpdate = true;\n\n\t} );\n\n\tconst computeFolder = gui.addFolder( 'voxelize' );\n\tcomputeFolder.add( params, 'resolution', 5, 75, 1 ).onChange( () => {\n\n\t\tneedsUpdate = true;\n\n\t} );\n\tcomputeFolder.add( params, 'scale', 0.1, 4 ).onChange( () => {\n\n\t\tneedsUpdate = true;\n\n\t} );\n\tcomputeFolder.add( params, 'solid' ).onChange( () => {\n\n\t\tneedsUpdate = true;\n\n\t} );\n\tcomputeFolder.add( params, 'insideOnly' ).onChange( () => {\n\n\t\tneedsUpdate = true;\n\n\t} );\n\tcomputeFolder.add( params, 'rebuild' );\n\n\tconst helpersFolder = gui.addFolder( 'helpers' );\n\thelpersFolder.add( params, 'displayMesh' );\n\thelpersFolder.add( params, 'displayBounds' );\n\n\twindow.addEventListener( 'resize', function () {\n\n\t\tcamera.aspect = window.innerWidth / window.innerHeight;\n\t\tcamera.updateProjectionMatrix();\n\n\t\trenderer.setSize( window.innerWidth, window.innerHeight );\n\n\t}, false );\n\n}\n\n// regenerate the mesh and bvh\nfunction* rebuildVoxels() {\n\n\tconst resolution = params.resolution;\n\tconst totalCount = resolution ** 3;\n\tconst dimensions = params.scale;\n\tconst step = dimensions / resolution;\n\tconst outsideColor = new THREE.Color( 0xffffff );\n\tconst insideColor = new THREE.Color( 0xFFC107 ).convertSRGBToLinear();\n\tif ( voxels && voxels.instanceMatrix.count !== totalCount ) {\n\n\t\tvoxels.material.dispose();\n\t\tvoxels.dispose();\n\t\tvoxels.parent.remove( voxels );\n\t\tvoxels = null;\n\n\t}\n\n\tconst { model, bvh } = models[ params.model ];\n\tif ( ! model ) {\n\n\t\treturn;\n\n\t}\n\n\tif ( ! voxels ) {\n\n\t\t// set color here to force a color buffer to initialize\n\t\tvoxels = new THREE.InstancedMesh( new RoundedBoxGeometry( 1, 1, 1, 4, 0.1 ), new THREE.MeshStandardMaterial(), totalCount );\n\t\tvoxels.setColorAt( 0, outsideColor );\n\t\tscene.add( voxels );\n\n\t}\n\n\tconst minStart = ( - dimensions / 2.0 ) + step * 0.5;\n\tconst position = new THREE.Vector3();\n\tconst quaternion = new THREE.Quaternion();\n\tconst scale = new THREE.Vector3().setScalar( step );\n\tconst worldMatrix = new THREE.Matrix4();\n\tconst box = new THREE.Box3();\n\tconst invMat = new THREE.Matrix4().copy( model.matrixWorld ).invert();\n\n\tconst ray = new THREE.Ray();\n\tray.direction.set( 0, 0, 1 );\n\n\tlet voxelCount = 0;\n\n\tfor ( let y = 0; y < resolution; y ++ ) {\n\n\t\tfor ( let x = 0; x < resolution; x ++ ) {\n\n\t\t\tfor ( let z = 0; z < resolution; z ++ ) {\n\n\t\t\t\tposition.set(\n\t\t\t\t\tminStart + x * step,\n\t\t\t\t\tminStart + y * step,\n\t\t\t\t\tminStart + z * step,\n\t\t\t\t);\n\n\t\t\t\tbox.min.setScalar( - 0.5 * step ).add( position );\n\t\t\t\tbox.max.setScalar( 0.5 * step ).add( position );\n\n\t\t\t\tconst res = bvh.intersectsBox( box, invMat );\n\t\t\t\tif ( res ) {\n\n\t\t\t\t\tif ( ! params.insideOnly ) {\n\n\t\t\t\t\t\tworldMatrix.compose( position, quaternion, scale );\n\t\t\t\t\t\tvoxels.setMatrixAt( voxelCount, worldMatrix );\n\t\t\t\t\t\tvoxels.setColorAt( voxelCount, outsideColor );\n\t\t\t\t\t\tvoxels.instanceMatrix.needsUpdate = true;\n\t\t\t\t\t\tvoxels.instanceColor.needsUpdate = true;\n\n\t\t\t\t\t\tvoxelCount ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( params.solid ) {\n\n\t\t\t\t\t// transform into the local frame of the model\n\t\t\t\t\tray.origin.copy( position ).applyMatrix4( invMat );\n\n\t\t\t\t\t// If we hit a face backside we know we're inside the mesh. Alternatively we\n\t\t\t\t\t// could check if we hit an odd number of faces when checking all intersections.\n\t\t\t\t\tconst res = bvh.raycastFirst( ray, 2 );\n\t\t\t\t\tif ( res && res.face.normal.dot( ray.direction ) > 0.0 ) {\n\n\t\t\t\t\t\tworldMatrix.compose( position, quaternion, scale );\n\t\t\t\t\t\tvoxels.setMatrixAt( voxelCount, worldMatrix );\n\t\t\t\t\t\tvoxels.setColorAt( voxelCount, insideColor );\n\t\t\t\t\t\tvoxels.instanceMatrix.needsUpdate = true;\n\t\t\t\t\t\tvoxels.instanceColor.needsUpdate = true;\n\n\t\t\t\t\t\tvoxelCount ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvoxels.count = voxelCount;\n\t\t\t\tyield;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tvoxels.count = voxelCount;\n\n}\n\nfunction render() {\n\n\tstats.update();\n\n\tscene.updateMatrixWorld( true );\n\n\t// kick off a new voxelization task\n\tif ( needsUpdate ) {\n\n\t\tvoxelTask = rebuildVoxels();\n\t\tneedsUpdate = false;\n\n\t}\n\n\t// tick the task forward\n\tif ( voxelTask ) {\n\n\t\tlet startTime = window.performance.now();\n\t\twhile ( window.performance.now() - startTime < 16 ) {\n\n\t\t\tconst res = voxelTask.next();\n\t\t\tif ( res.done ) {\n\n\t\t\t\tvoxelTask = null;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif ( boxHelper ) {\n\n\t\tboxHelper.object.scale.setScalar( params.scale );\n\t\tboxHelper.object.updateMatrixWorld( true );\n\t\tboxHelper.update();\n\n\t}\n\n\t// hide the models\n\tfor ( const key in models ) {\n\n\t\tconst info = models[ key ];\n\t\tif ( info.model ) info.model.visible = false;\n\n\t}\n\n\t// show the select model\n\tconst { model } = models[ params.model ];\n\tif ( model ) {\n\n\t\tmodel.visible = params.displayMesh;\n\t\tboxHelper.visible = params.displayBounds;\n\n\t}\n\n\trenderer.render( scene, camera );\n\n}\n"],"names":["renderer","camera","scene","gui","stats","voxels","boxHelper","needsUpdate","voxelTask","params","models","init","THREE.WebGLRenderer","render","THREE.sRGBEncoding","THREE.Scene","light","THREE.DirectionalLight","revLight","ambient","THREE.AmbientLight","THREE.PerspectiveCamera","OrbitControls","Stats","wireframeMaterial","THREE.MeshBasicMaterial","GLTFLoader","MeshoptDecoder","gltf","model","GenerateMeshBVHWorker","bvh","THREE.Mesh","THREE.TorusKnotGeometry","MeshBVH","boxHelperMesh","THREE.BoxGeometry","THREE.BoxHelper","GUI","computeFolder","helpersFolder","rebuildVoxels","resolution","totalCount","dimensions","step","outsideColor","THREE.Color","insideColor","THREE.InstancedMesh","RoundedBoxGeometry","THREE.MeshStandardMaterial","minStart","position","THREE.Vector3","quaternion","THREE.Quaternion","scale","worldMatrix","THREE.Matrix4","box","THREE.Box3","invMat","ray","THREE.Ray","voxelCount","y","x","z","res","startTime","key","info"],"mappings":"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"}