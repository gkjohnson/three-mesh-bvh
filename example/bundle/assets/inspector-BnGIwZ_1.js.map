{"version":3,"file":"inspector-BnGIwZ_1.js","sources":["../../inspector.js"],"sourcesContent":["import * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { FullScreenQuad } from 'three/examples/jsm/postprocessing/Pass.js';\n\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min.js';\nimport {\n\tacceleratedRaycast, computeBoundsTree, disposeBoundsTree, BVHHelper,\n\tSAH, CENTER, AVERAGE, getBVHExtremes, estimateMemoryInBytes,\n} from 'three-mesh-bvh';\n\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\nTHREE.BufferGeometry.prototype.computeBoundsTree = computeBoundsTree;\nTHREE.BufferGeometry.prototype.disposeBoundsTree = disposeBoundsTree;\n\nlet scene, camera, renderer, helper, mesh, outputContainer, benchmarkContainer;\nlet benchmarkViz, renderTarget, fsQuad;\nlet mouse = new THREE.Vector2();\nconst readBuffer = new Float32Array( 1 );\n\nconst modelPath = 'https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/dragon-attenuation/DragonAttenuation.glb';\nconst params = {\n\n\toptions: {\n\t\tstrategy: SAH,\n\t\tmaxLeafSize: 10,\n\t\tmaxDepth: 40,\n\t\trebuild: function () {\n\n\t\t\tupdateBVH();\n\n\t\t},\n\t},\n\n\tvisualization: {\n\n\t\tdisplayMesh: true,\n\t\tsimpleColors: false,\n\t\toutline: true,\n\t\ttraversalThreshold: 50,\n\n\t},\n\n\tbenchmark: {\n\n\t\tdisplayRays: false,\n\t\tfirstHitOnly: true,\n\t\trotations: 10,\n\t\tcastCount: 1000,\n\n\t}\n\n};\n\nconst BOUNDS_COLOR = new THREE.Color( 0xffe66e ).convertLinearToSRGB().getHex();\nconst BG_COLOR = 0x00636d;\nconst THRESHOLD_COLOR = 0xf560a7;\n\nclass TraverseMaterial extends THREE.ShaderMaterial {\n\n\tconstructor( params ) {\n\n\t\tsuper( {\n\n\t\t\tuniforms: {\n\t\t\t\tmap: { value: null },\n\t\t\t\tthreshold: { value: 35 },\n\n\t\t\t\tboundsColor: { value: new THREE.Color( 0xffffff ) },\n\t\t\t\tbackgroundColor: { value: new THREE.Color( 0x000000 ) },\n\t\t\t\tthresholdColor: { value: new THREE.Color( 0xff0000 ) },\n\t\t\t\tresolution: { value: new THREE.Vector2() },\n\t\t\t\toutlineAlpha: { value: 0.5 },\n\t\t\t},\n\n\t\t\tvertexShader: /* glsl */`\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t\t}\n\t\t\t`,\n\n\t\t\tfragmentShader: /* glsl */`\n\t\t\t\tuniform sampler2D map;\n\t\t\t\tuniform float threshold;\n\n\t\t\t\tuniform vec3 thresholdColor;\n\t\t\t\tuniform vec3 boundsColor;\n\t\t\t\tuniform vec3 backgroundColor;\n\t\t\t\tuniform vec2 resolution;\n\t\t\t\tuniform float outlineAlpha;\n\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat count = texture2D( map, vUv ).r;\n\n\t\t\t\t\tif ( count == 0.0 ) {\n\n\t\t\t\t\t\tvec2 offset = 1.0 / resolution;\n\t\t\t\t\t\tfloat c1 = texture2D( map, vUv + offset * vec2( 1.0, 0.0 ) ).r;\n\t\t\t\t\t\tfloat c2 = texture2D( map, vUv + offset * vec2( - 1.0, 0.0 ) ).r;\n\t\t\t\t\t\tfloat c3 = texture2D( map, vUv + offset * vec2( 0.0, 1.0 ) ).r;\n\t\t\t\t\t\tfloat c4 = texture2D( map, vUv + offset * vec2( 0.0, - 1.0 ) ).r;\n\n\t\t\t\t\t\tfloat maxC = max( c1, max( c2, max( c3, c4 ) ) );\n\t\t\t\t\t\tif ( maxC != 0.0 ) {\n\n\t\t\t\t\t\t\tgl_FragColor.rgb = mix( backgroundColor, mix( boundsColor, vec3( 1.0 ), 0.5 ), outlineAlpha );\n\t\t\t\t\t\t\tgl_FragColor.a = 1.0;\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( count > threshold ) {\n\n\t\t\t\t\t\tgl_FragColor.rgb = thresholdColor.rgb;\n\t\t\t\t\t\tgl_FragColor.a = 1.0;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tfloat alpha = count / threshold;\n\t\t\t\t\t\tvec3 color = mix( boundsColor, vec3( 1.0 ), pow( alpha, 1.75 ) );\n\n\t\t\t\t\t\tgl_FragColor.rgb = mix( backgroundColor, color, alpha ).rgb ;\n\t\t\t\t\t\tgl_FragColor.a = 1.0;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t`,\n\n\t\t} );\n\n\t\tconst uniforms = this.uniforms;\n\t\tfor ( const key in uniforms ) {\n\n\t\t\tObject.defineProperty( this, key, {\n\n\t\t\t\tget() {\n\n\t\t\t\t\treturn this.uniforms[ key ].value;\n\n\t\t\t\t},\n\n\t\t\t\tset( v ) {\n\n\t\t\t\t\tthis.uniforms[ key ].value = v;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\tthis.setValues( params );\n\n\t}\n\n}\n\nfunction init() {\n\n\toutputContainer = document.getElementById( 'output' );\n\tbenchmarkContainer = document.getElementById( 'benchmark' );\n\n\t// renderer setup\n\trenderer = new THREE.WebGLRenderer( { antialias: true } );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.setClearColor( 0, 1 );\n\trenderer.setAnimationLoop( render );\n\tdocument.body.appendChild( renderer.domElement );\n\n\t// render target\n\trenderTarget = new THREE.WebGLRenderTarget( 1, 1, {\n\t\tformat: THREE.RedFormat,\n\t\ttype: THREE.FloatType,\n\n\t\t// TODO: Use integer buffers once better supported in three.js\n\t\t// format: THREE.RedIntegerFormat,\n\t\t// type: THREE.UnsignedIntType,\n\t\t// internalFormat: 'R16UI'\n\t} );\n\n\tfsQuad = new FullScreenQuad( new TraverseMaterial( {\n\n\t\tmap: renderTarget.texture,\n\t\tdepthWrite: false,\n\n\t} ) );\n\n\t// scene setup\n\tscene = new THREE.Scene();\n\n\t// camera setup\n\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 50 );\n\tcamera.position.set( - 2.5, 1.5, 2.5 );\n\tcamera.far = 100;\n\tcamera.updateProjectionMatrix();\n\n\tnew OrbitControls( camera, renderer.domElement );\n\n\twindow.addEventListener( 'resize', onResize, false );\n\tonResize();\n\n\t// Load dragon\n\tconst loader = new GLTFLoader();\n\tloader\n\t\t.load( modelPath, gltf => {\n\n\t\t\tgltf.scene.traverse( c => {\n\n\t\t\t\tif ( c.isMesh && c.name === 'Dragon' ) {\n\n\t\t\t\t\tmesh = c;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tmesh.material = new THREE.MeshBasicMaterial( { colorWrite: false } );\n\t\t\tmesh.geometry.center();\n\t\t\tmesh.position.set( 0, 0, 0 );\n\t\t\tscene.add( mesh );\n\n\t\t\thelper = new BVHHelper( mesh, 40 );\n\t\t\thelper.displayEdges = false;\n\t\t\thelper.displayParents = true;\n\t\t\thelper.color.set( 0xffffff );\n\t\t\thelper.opacity = 1;\n\t\t\thelper.depth = 40;\n\n\t\t\tconst material = helper.meshMaterial;\n\t\t\tmaterial.blending = THREE.CustomBlending;\n\t\t\tmaterial.blendDst = THREE.OneFactor;\n\n\t\t\tscene.add( helper );\n\n\t\t\tupdateBVH();\n\n\t\t\trunBenchmark( true );\n\n\t\t} );\n\n\tbenchmarkViz = new THREE.LineSegments();\n\tbenchmarkViz.material.opacity = 0.1;\n\tbenchmarkViz.material.transparent = true;\n\tbenchmarkViz.material.depthWrite = false;\n\tbenchmarkViz.frustumCulled = false;\n\tscene.add( benchmarkViz );\n\n\tconst gui = new GUI();\n\tconst bvhFolder = gui.addFolder( 'BVH' );\n\tbvhFolder.add( params.options, 'strategy', { CENTER, AVERAGE, SAH } );\n\tbvhFolder.add( params.options, 'maxLeafSize', 1, 30, 1 );\n\tbvhFolder.add( params.options, 'maxDepth', 1, 40, 1 );\n\tbvhFolder.add( params.options, 'rebuild' );\n\tbvhFolder.open();\n\n\tconst vizFolder = gui.addFolder( 'Visualization' );\n\tvizFolder.add( params.visualization, 'displayMesh' );\n\tvizFolder.add( params.visualization, 'simpleColors' );\n\tvizFolder.add( params.visualization, 'outline' );\n\tvizFolder.add( params.visualization, 'traversalThreshold', 1, 300, 1 );\n\tvizFolder.open();\n\n\tconst benchmarkFolder = gui.addFolder( 'Benchmark' );\n\tbenchmarkFolder.add( params.benchmark, 'displayRays' );\n\tbenchmarkFolder.add( params.benchmark, 'firstHitOnly' ).onChange( resetBenchmark );\n\tbenchmarkFolder.add( params.benchmark, 'castCount', 100, 5000, 1 ).onChange( () => {\n\n\t\tresetBenchmark();\n\t\trunBenchmark( true );\n\n\t} );\n\tbenchmarkFolder.add( params.benchmark, 'rotations', 1, 20, 1 ).onChange( () => {\n\n\t\tresetBenchmark();\n\t\trunBenchmark( true );\n\n\t} );\n\tbenchmarkFolder.open();\n\n\twindow.addEventListener( 'pointermove', e => {\n\n\t\tmouse.set( e.clientX, window.innerHeight - e.clientY );\n\n\t} );\n\n}\n\nfunction onResize() {\n\n\tcamera.aspect = window.innerWidth / window.innerHeight;\n\tcamera.updateProjectionMatrix();\n\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\n\trenderTarget.setSize(\n\t\twindow.innerWidth * window.devicePixelRatio,\n\t\twindow.innerHeight * window.devicePixelRatio,\n\t);\n\n}\n\nfunction updateBVH() {\n\n\tconst startTime = performance.now();\n\tmesh.geometry.computeBoundsTree( {\n\t\tstrategy: parseInt( params.options.strategy ),\n\t\tmaxLeafSize: params.options.maxLeafSize,\n\t\tmaxDepth: params.options.maxDepth,\n\t} );\n\tconst deltaTime = performance.now() - startTime;\n\thelper.update();\n\n\tresetBenchmark();\n\n\tconst info = getBVHExtremes( mesh.geometry.boundsTree )[ 0 ];\n\toutputContainer.innerText =\n\t\t`construction time        : ${ deltaTime.toFixed( 2 ) }ms\\n` +\n\t\t`surface area score       : ${ info.surfaceAreaScore.toFixed( 2 ) }\\n` +\n\t\t`total nodes              : ${ info.nodeCount }\\n` +\n\t\t`total leaf nodes         : ${ info.leafNodeCount }\\n` +\n\t\t`min / max tris per leaf  : ${ info.tris.min } / ${ info.tris.max }\\n` +\n\t\t`min / max depth          : ${ info.depth.min } / ${ info.depth.max }\\n` +\n\t\t`memory (incl. geometry)  : ${ ( estimateMemoryInBytes( mesh.geometry.boundsTree ) * 1e-6 ).toFixed( 3 ) } mb \\n` +\n\t\t`memory (excl. geometry)  : ${ ( estimateMemoryInBytes( mesh.geometry.boundsTree._roots ) * 1e-6 ).toFixed( 3 ) } mb`;\n\n}\n\nfunction runBenchmark( updateGeom = false ) {\n\n\tlet points = null;\n\tlet newGeometry = null;\n\tif ( updateGeom ) {\n\n\t\tmesh.updateMatrixWorld();\n\t\tnewGeometry = new THREE.BufferGeometry();\n\t\tbenchmarkViz.geometry.dispose();\n\t\tpoints = [];\n\n\t}\n\n\tconst raycaster = new THREE.Raycaster();\n\traycaster.firstHitOnly = params.benchmark.firstHitOnly;\n\n\tconst rayCount = params.benchmark.castCount;\n\tconst rotations = params.benchmark.rotations;\n\tconst { ray } = raycaster;\n\tconst { origin, direction } = ray;\n\n\tconst startTime = performance.now();\n\tfor ( let i = 0; i < rayCount; i ++ ) {\n\n\t\tconst step = i / rayCount;\n\t\tconst y = step - 0.5;\n\t\torigin.set(\n\t\t\tMath.cos( 0.75 * Math.PI * y ) * Math.sin( rotations * 2 * Math.PI * i / rayCount ),\n\t\t\t2 * y,\n\t\t\tMath.cos( 0.75 * Math.PI * y ) * Math.cos( rotations * 2 * Math.PI * i / rayCount ),\n\t\t).multiplyScalar( 2.5 );\n\n\t\tdirection.set(\n\t\t\tMath.cos( rotations * 5 * y ),\n\t\t\tMath.sin( rotations * 10 * y ),\n\t\t\tMath.sin( rotations * 5 * y ),\n\t\t).sub( origin ).normalize();\n\n\t\traycaster.intersectObject( mesh );\n\n\t\tif ( updateGeom ) {\n\n\t\t\tconst hit = raycaster.intersectObject( mesh )[ 0 ];\n\n\t\t\tpoints.push( origin.clone() );\n\t\t\tif ( hit ) {\n\n\t\t\t\tpoints.push( hit.point.clone() );\n\n\t\t\t} else {\n\n\t\t\t\tconst v = new THREE.Vector3();\n\t\t\t\tray.at( 5, v );\n\t\t\t\tpoints.push( v );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tconst deltaTime = performance.now() - startTime;\n\n\tif ( updateGeom ) {\n\n\t\tnewGeometry.setFromPoints( points );\n\t\tbenchmarkViz.geometry = newGeometry;\n\n\t}\n\n\treturn deltaTime;\n\n}\n\nlet sampleCount = 0;\nlet currTime = 0;\n\nfunction resetBenchmark() {\n\n\tsampleCount = 0;\n\tcurrTime = 0;\n\n}\n\nfunction render() {\n\n\t// read the buffer from the last frame of rendering so we don't block\n\t// waiting for this frame to finish.\n\tconst pixelRatio = renderer.getPixelRatio();\n\trenderer.readRenderTargetPixels(\n\t\trenderTarget,\n\t\tmouse.x * pixelRatio, mouse.y * pixelRatio, 1, 1,\n\t\treadBuffer,\n\t);\n\n\tif ( mesh ) {\n\n\t\tsampleCount = Math.min( sampleCount + 1, 50 );\n\t\tcurrTime += ( runBenchmark() - currTime ) / sampleCount;\n\t\tbenchmarkContainer.innerText =\n\t\t\t`\\ntraversal depth at mouse : ${ Math.round( readBuffer[ 0 ] ) }\\n` +\n\t\t\t`benchmark rolling avg    : ${ currTime.toFixed( 3 ) } ms`;\n\n\t}\n\n\tif ( params.visualization.simpleColors ) {\n\n\t\tfsQuad.material.boundsColor.set( 0xffffff );\n\t\tfsQuad.material.thresholdColor.set( 0xff0000 );\n\t\tfsQuad.material.backgroundColor.set( 0x000000 );\n\n\t} else {\n\n\t\tfsQuad.material.boundsColor.set( BOUNDS_COLOR );\n\t\tfsQuad.material.thresholdColor.set( THRESHOLD_COLOR );\n\t\tfsQuad.material.backgroundColor.set( BG_COLOR );\n\n\t}\n\n\tfsQuad.material.threshold = params.visualization.traversalThreshold;\n\tfsQuad.material.outlineAlpha = params.visualization.outline ? 0.5 : 0.0;\n\tfsQuad.material.resolution.set( renderTarget.width, renderTarget.height );\n\n\t// render bvh\n\tbenchmarkViz.visible = false;\n\trenderer.autoClear = true;\n\tif ( mesh ) mesh.visible = params.visualization.displayMesh;\n\trenderer.setRenderTarget( renderTarget );\n\trenderer.render( scene, camera );\n\n\trenderer.setRenderTarget( null );\n\tfsQuad.render( renderer );\n\n\t// render rays\n\trenderer.autoClear = false;\n\tbenchmarkViz.visible = params.benchmark.displayRays;\n\n\tif ( mesh ) renderer.render( mesh, camera );\n\trenderer.render( benchmarkViz, camera );\n\n}\n\n\ninit();\n"],"names":["THREE.Mesh","acceleratedRaycast","THREE.BufferGeometry","computeBoundsTree","disposeBoundsTree","scene","camera","renderer","helper","mesh","outputContainer","benchmarkContainer","benchmarkViz","renderTarget","fsQuad","mouse","THREE.Vector2","readBuffer","modelPath","params","SAH","updateBVH","BOUNDS_COLOR","THREE.Color","BG_COLOR","THRESHOLD_COLOR","TraverseMaterial","THREE.ShaderMaterial","uniforms","key","v","init","THREE.WebGLRenderer","render","THREE.WebGLRenderTarget","THREE.RedFormat","THREE.FloatType","FullScreenQuad","THREE.Scene","THREE.PerspectiveCamera","OrbitControls","onResize","GLTFLoader","gltf","c","THREE.MeshBasicMaterial","BVHHelper","material","THREE.CustomBlending","THREE.OneFactor","runBenchmark","THREE.LineSegments","gui","GUI","bvhFolder","CENTER","AVERAGE","vizFolder","benchmarkFolder","resetBenchmark","e","startTime","deltaTime","info","getBVHExtremes","estimateMemoryInBytes","updateGeom","points","newGeometry","raycaster","THREE.Raycaster","rayCount","rotations","ray","origin","direction","i","y","hit","THREE.Vector3","sampleCount","currTime","pixelRatio"],"mappings":"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"}