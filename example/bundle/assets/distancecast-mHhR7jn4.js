import{M as z1,i as a0,B as G1,u as V1,K as d0,V as l0,C as T1,W as c0,p as x0,c as f0,d as h0,D as u0,A as p0,s as v0,g as q1,t as r0,P as m0,G as n0,l as y0,e as w0,f as z0,X as A0,O as b0,n as e0}from"./ExtendedTriangle-hsPasuNU.js";/* empty css               */import{S as M0}from"./Stats-9dH8FB2H.js";import{g as g0}from"./lil-gui.module.min-BH_YJbPT.js";import{O as C0}from"./OrbitControls-DEZHvbFX.js";import{T as S0}from"./TransformControls-DGYuTlwP.js";import{g as F0}from"./_commonjsHelpers-CqkleIqs.js";import{a as P0,c as D0,d as T0}from"./ExtensionUtilities-BlnM4xb7.js";import{B as W0}from"./BVHHelper-DA_xcAFF.js";import"./MeshBVH-DQV6PBDm.js";class k0 extends z1{constructor(U,V,X=!1,Y=!1,T=1e4){const B=new a0;super(B,V),this.isMarchingCubes=!0;const e=this,W=new Float32Array(36),E=new Float32Array(36),H=new Float32Array(36);this.enableUvs=X,this.enableColors=Y,this.init=function(t){this.resolution=t,this.isolation=80,this.size=t,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(this.size3*3),this.palette=new Float32Array(this.size3*3),this.count=0;const a=T*3;this.positionArray=new Float32Array(a*3);const r=new G1(this.positionArray,3);r.setUsage(V1),B.setAttribute("position",r),this.normalArray=new Float32Array(a*3);const s=new G1(this.normalArray,3);if(s.setUsage(V1),B.setAttribute("normal",s),this.enableUvs){this.uvArray=new Float32Array(a*2);const n=new G1(this.uvArray,2);n.setUsage(V1),B.setAttribute("uv",n)}if(this.enableColors){this.colorArray=new Float32Array(a*3);const n=new G1(this.colorArray,3);n.setUsage(V1),B.setAttribute("color",n)}B.boundingSphere=new d0(new l0,1)};function C(t,a,r){return t+(a-t)*r}function v(t,a,r,s,n,o,i,c,l,f){const x=(r-i)/(c-i),u=e.normal_cache;W[a+0]=s+x*e.delta,W[a+1]=n,W[a+2]=o,E[a+0]=C(u[t+0],u[t+3],x),E[a+1]=C(u[t+1],u[t+4],x),E[a+2]=C(u[t+2],u[t+5],x),H[a+0]=C(e.palette[l*3+0],e.palette[f*3+0],x),H[a+1]=C(e.palette[l*3+1],e.palette[f*3+1],x),H[a+2]=C(e.palette[l*3+2],e.palette[f*3+2],x)}function h(t,a,r,s,n,o,i,c,l,f){const x=(r-i)/(c-i),u=e.normal_cache;W[a+0]=s,W[a+1]=n+x*e.delta,W[a+2]=o;const m=t+e.yd*3;E[a+0]=C(u[t+0],u[m+0],x),E[a+1]=C(u[t+1],u[m+1],x),E[a+2]=C(u[t+2],u[m+2],x),H[a+0]=C(e.palette[l*3+0],e.palette[f*3+0],x),H[a+1]=C(e.palette[l*3+1],e.palette[f*3+1],x),H[a+2]=C(e.palette[l*3+2],e.palette[f*3+2],x)}function w(t,a,r,s,n,o,i,c,l,f){const x=(r-i)/(c-i),u=e.normal_cache;W[a+0]=s,W[a+1]=n,W[a+2]=o+x*e.delta;const m=t+e.zd*3;E[a+0]=C(u[t+0],u[m+0],x),E[a+1]=C(u[t+1],u[m+1],x),E[a+2]=C(u[t+2],u[m+2],x),H[a+0]=C(e.palette[l*3+0],e.palette[f*3+0],x),H[a+1]=C(e.palette[l*3+1],e.palette[f*3+1],x),H[a+2]=C(e.palette[l*3+2],e.palette[f*3+2],x)}function p(t){const a=t*3;e.normal_cache[a]===0&&(e.normal_cache[a+0]=e.field[t-1]-e.field[t+1],e.normal_cache[a+1]=e.field[t-e.yd]-e.field[t+e.yd],e.normal_cache[a+2]=e.field[t-e.zd]-e.field[t+e.zd])}function d(t,a,r,s,n){const o=s+1,i=s+e.yd,c=s+e.zd,l=o+e.yd,f=o+e.zd,x=s+e.yd+e.zd,u=o+e.yd+e.zd;let m=0;const z=e.field[s],A=e.field[o],b=e.field[i],M=e.field[l],F=e.field[c],g=e.field[f],P=e.field[x],D=e.field[u];z<n&&(m|=1),A<n&&(m|=2),b<n&&(m|=8),M<n&&(m|=4),F<n&&(m|=16),g<n&&(m|=32),P<n&&(m|=128),D<n&&(m|=64);const S=B0[m];if(S===0)return 0;const k=e.delta,I=t+k,N=a+k,L=r+k;S&1&&(p(s),p(o),v(s*3,0,n,t,a,r,z,A,s,o)),S&2&&(p(o),p(l),h(o*3,3,n,I,a,r,A,M,o,l)),S&4&&(p(i),p(l),v(i*3,6,n,t,N,r,b,M,i,l)),S&8&&(p(s),p(i),h(s*3,9,n,t,a,r,z,b,s,i)),S&16&&(p(c),p(f),v(c*3,12,n,t,a,L,F,g,c,f)),S&32&&(p(f),p(u),h(f*3,15,n,I,a,L,g,D,f,u)),S&64&&(p(x),p(u),v(x*3,18,n,t,N,L,P,D,x,u)),S&128&&(p(c),p(x),h(c*3,21,n,t,a,L,F,P,c,x)),S&256&&(p(s),p(c),w(s*3,24,n,t,a,r,z,F,s,c)),S&512&&(p(o),p(f),w(o*3,27,n,I,a,r,A,g,o,f)),S&1024&&(p(l),p(u),w(l*3,30,n,I,N,r,M,D,l,u)),S&2048&&(p(i),p(x),w(i*3,33,n,t,N,r,b,P,i,x)),m<<=4;let _,$,J,Z=0,G=0;for(;H1[m+G]!=-1;)_=m+G,$=_+1,J=_+2,y(W,E,H,3*H1[_],3*H1[$],3*H1[J]),G+=3,Z++;return Z}function y(t,a,r,s,n,o){const i=e.count*3;if(e.positionArray[i+0]=t[s],e.positionArray[i+1]=t[s+1],e.positionArray[i+2]=t[s+2],e.positionArray[i+3]=t[n],e.positionArray[i+4]=t[n+1],e.positionArray[i+5]=t[n+2],e.positionArray[i+6]=t[o],e.positionArray[i+7]=t[o+1],e.positionArray[i+8]=t[o+2],e.material.flatShading===!0){const c=(a[s+0]+a[n+0]+a[o+0])/3,l=(a[s+1]+a[n+1]+a[o+1])/3,f=(a[s+2]+a[n+2]+a[o+2])/3;e.normalArray[i+0]=c,e.normalArray[i+1]=l,e.normalArray[i+2]=f,e.normalArray[i+3]=c,e.normalArray[i+4]=l,e.normalArray[i+5]=f,e.normalArray[i+6]=c,e.normalArray[i+7]=l,e.normalArray[i+8]=f}else e.normalArray[i+0]=a[s+0],e.normalArray[i+1]=a[s+1],e.normalArray[i+2]=a[s+2],e.normalArray[i+3]=a[n+0],e.normalArray[i+4]=a[n+1],e.normalArray[i+5]=a[n+2],e.normalArray[i+6]=a[o+0],e.normalArray[i+7]=a[o+1],e.normalArray[i+8]=a[o+2];if(e.enableUvs){const c=e.count*2;e.uvArray[c+0]=t[s+0],e.uvArray[c+1]=t[s+2],e.uvArray[c+2]=t[n+0],e.uvArray[c+3]=t[n+2],e.uvArray[c+4]=t[o+0],e.uvArray[c+5]=t[o+2]}e.enableColors&&(e.colorArray[i+0]=r[s+0],e.colorArray[i+1]=r[s+1],e.colorArray[i+2]=r[s+2],e.colorArray[i+3]=r[n+0],e.colorArray[i+4]=r[n+1],e.colorArray[i+5]=r[n+2],e.colorArray[i+6]=r[o+0],e.colorArray[i+7]=r[o+1],e.colorArray[i+8]=r[o+2]),e.count+=3}this.addBall=function(t,a,r,s,n,o){const i=Math.sign(s);s=Math.abs(s);const c=o!=null;let l=new T1(t,a,r);if(c)try{l=o instanceof T1?o:Array.isArray(o)?new T1(Math.min(Math.abs(o[0]),1),Math.min(Math.abs(o[1]),1),Math.min(Math.abs(o[2]),1)):new T1(o)}catch{l=new T1(t,a,r)}const f=this.size*Math.sqrt(s/n),x=r*this.size,u=a*this.size,m=t*this.size;let z=Math.floor(x-f);z<1&&(z=1);let A=Math.floor(x+f);A>this.size-1&&(A=this.size-1);let b=Math.floor(u-f);b<1&&(b=1);let M=Math.floor(u+f);M>this.size-1&&(M=this.size-1);let F=Math.floor(m-f);F<1&&(F=1);let g=Math.floor(m+f);g>this.size-1&&(g=this.size-1);let P,D,S,k,I,N,L,_,$,J,Z;for(S=z;S<A;S++)for(I=this.size2*S,_=S/this.size-r,$=_*_,D=b;D<M;D++)for(k=I+this.size*D,L=D/this.size-a,J=L*L,P=F;P<g;P++)if(N=P/this.size-t,Z=s/(1e-6+N*N+J+$)-n,Z>0){this.field[k+P]+=Z*i;const G=Math.sqrt((P-m)*(P-m)+(D-u)*(D-u)+(S-x)*(S-x))/f,q=1-G*G*G*(G*(G*6-15)+10);this.palette[(k+P)*3+0]+=l.r*q,this.palette[(k+P)*3+1]+=l.g*q,this.palette[(k+P)*3+2]+=l.b*q}},this.addPlaneX=function(t,a){const r=this.size,s=this.yd,n=this.zd,o=this.field;let i,c,l,f,x,u,m,z=r*Math.sqrt(t/a);for(z>r&&(z=r),i=0;i<z;i++)if(u=i/r,f=u*u,x=t/(1e-4+f)-a,x>0)for(c=0;c<r;c++)for(m=i+c*s,l=0;l<r;l++)o[n*l+m]+=x},this.addPlaneY=function(t,a){const r=this.size,s=this.yd,n=this.zd,o=this.field;let i,c,l,f,x,u,m,z,A=r*Math.sqrt(t/a);for(A>r&&(A=r),c=0;c<A;c++)if(u=c/r,f=u*u,x=t/(1e-4+f)-a,x>0)for(m=c*s,i=0;i<r;i++)for(z=m+i,l=0;l<r;l++)o[n*l+z]+=x},this.addPlaneZ=function(t,a){const r=this.size,s=this.yd,n=this.zd,o=this.field;let i,c,l,f,x,u,m,z,A=r*Math.sqrt(t/a);for(A>r&&(A=r),l=0;l<A;l++)if(u=l/r,f=u*u,x=t/(1e-4+f)-a,x>0)for(m=n*l,c=0;c<r;c++)for(z=m+c*s,i=0;i<r;i++)o[z+i]+=x},this.setCell=function(t,a,r,s){const n=this.size2*r+this.size*a+t;this.field[n]=s},this.getCell=function(t,a,r){const s=this.size2*r+this.size*a+t;return this.field[s]},this.blur=function(t=1){const a=this.field,r=a.slice(),s=this.size,n=this.size2;for(let o=0;o<s;o++)for(let i=0;i<s;i++)for(let c=0;c<s;c++){const l=n*c+s*i+o;let f=r[l],x=1;for(let u=-1;u<=1;u+=2){const m=u+o;if(!(m<0||m>=s))for(let z=-1;z<=1;z+=2){const A=z+i;if(!(A<0||A>=s))for(let b=-1;b<=1;b+=2){const M=b+c;if(M<0||M>=s)continue;const F=n*M+s*A+m,g=r[F];x++,f+=t*(g-f)/x}}}a[l]=f}},this.reset=function(){for(let t=0;t<this.size3;t++)this.normal_cache[t*3]=0,this.field[t]=0,this.palette[t*3]=this.palette[t*3+1]=this.palette[t*3+2]=0},this.update=function(){this.count=0;const t=this.size-2;for(let a=1;a<t;a++){const r=this.size2*a,s=(a-this.halfsize)/this.halfsize;for(let n=1;n<t;n++){const o=r+this.size*n,i=(n-this.halfsize)/this.halfsize;for(let c=1;c<t;c++){const l=(c-this.halfsize)/this.halfsize,f=o+c;d(l,i,s,f,this.isolation)}}}this.geometry.setDrawRange(0,this.count),B.getAttribute("position").needsUpdate=!0,B.getAttribute("normal").needsUpdate=!0,this.enableUvs&&(B.getAttribute("uv").needsUpdate=!0),this.enableColors&&(B.getAttribute("color").needsUpdate=!0),this.count/3>T&&console.warn("THREE.MarchingCubes: Geometry buffers too small for rendering. Please create an instance with a higher poly count.")},this.init(U)}}const B0=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),H1=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);var I1={exports:{}},s0;function E0(){return s0||(s0=1,(function(K,U){(function(){var V=.5*(Math.sqrt(3)-1),X=(3-Math.sqrt(3))/6,Y=1/3,T=1/6,B=(Math.sqrt(5)-1)/4,e=(5-Math.sqrt(5))/20;function W(v){var h;typeof v=="function"?h=v:v?h=H(v):h=Math.random,this.p=E(h),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var w=0;w<512;w++)this.perm[w]=this.p[w&255],this.permMod12[w]=this.perm[w]%12}W.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(v,h){var w=this.permMod12,p=this.perm,d=this.grad3,y=0,t=0,a=0,r=(v+h)*V,s=Math.floor(v+r),n=Math.floor(h+r),o=(s+n)*X,i=s-o,c=n-o,l=v-i,f=h-c,x,u;l>f?(x=1,u=0):(x=0,u=1);var m=l-x+X,z=f-u+X,A=l-1+2*X,b=f-1+2*X,M=s&255,F=n&255,g=.5-l*l-f*f;if(g>=0){var P=w[M+p[F]]*3;g*=g,y=g*g*(d[P]*l+d[P+1]*f)}var D=.5-m*m-z*z;if(D>=0){var S=w[M+x+p[F+u]]*3;D*=D,t=D*D*(d[S]*m+d[S+1]*z)}var k=.5-A*A-b*b;if(k>=0){var I=w[M+1+p[F+1]]*3;k*=k,a=k*k*(d[I]*A+d[I+1]*b)}return 70*(y+t+a)},noise3D:function(v,h,w){var p=this.permMod12,d=this.perm,y=this.grad3,t,a,r,s,n=(v+h+w)*Y,o=Math.floor(v+n),i=Math.floor(h+n),c=Math.floor(w+n),l=(o+i+c)*T,f=o-l,x=i-l,u=c-l,m=v-f,z=h-x,A=w-u,b,M,F,g,P,D;m>=z?z>=A?(b=1,M=0,F=0,g=1,P=1,D=0):m>=A?(b=1,M=0,F=0,g=1,P=0,D=1):(b=0,M=0,F=1,g=1,P=0,D=1):z<A?(b=0,M=0,F=1,g=0,P=1,D=1):m<A?(b=0,M=1,F=0,g=0,P=1,D=1):(b=0,M=1,F=0,g=1,P=1,D=0);var S=m-b+T,k=z-M+T,I=A-F+T,N=m-g+2*T,L=z-P+2*T,_=A-D+2*T,$=m-1+3*T,J=z-1+3*T,Z=A-1+3*T,G=o&255,q=i&255,c1=c&255,r1=.6-m*m-z*z-A*A;if(r1<0)t=0;else{var u1=p[G+d[q+d[c1]]]*3;r1*=r1,t=r1*r1*(y[u1]*m+y[u1+1]*z+y[u1+2]*A)}var n1=.6-S*S-k*k-I*I;if(n1<0)a=0;else{var p1=p[G+b+d[q+M+d[c1+F]]]*3;n1*=n1,a=n1*n1*(y[p1]*S+y[p1+1]*k+y[p1+2]*I)}var s1=.6-N*N-L*L-_*_;if(s1<0)r=0;else{var v1=p[G+g+d[q+P+d[c1+D]]]*3;s1*=s1,r=s1*s1*(y[v1]*N+y[v1+1]*L+y[v1+2]*_)}var o1=.6-$*$-J*J-Z*Z;if(o1<0)s=0;else{var m1=p[G+1+d[q+1+d[c1+1]]]*3;o1*=o1,s=o1*o1*(y[m1]*$+y[m1+1]*J+y[m1+2]*Z)}return 32*(t+a+r+s)},noise4D:function(v,h,w,p){var d=this.perm,y=this.grad4,t,a,r,s,n,o=(v+h+w+p)*B,i=Math.floor(v+o),c=Math.floor(h+o),l=Math.floor(w+o),f=Math.floor(p+o),x=(i+c+l+f)*e,u=i-x,m=c-x,z=l-x,A=f-x,b=v-u,M=h-m,F=w-z,g=p-A,P=0,D=0,S=0,k=0;b>M?P++:D++,b>F?P++:S++,b>g?P++:k++,M>F?D++:S++,M>g?D++:k++,F>g?S++:k++;var I,N,L,_,$,J,Z,G,q,c1,r1,u1;I=P>=3?1:0,N=D>=3?1:0,L=S>=3?1:0,_=k>=3?1:0,$=P>=2?1:0,J=D>=2?1:0,Z=S>=2?1:0,G=k>=2?1:0,q=P>=1?1:0,c1=D>=1?1:0,r1=S>=1?1:0,u1=k>=1?1:0;var n1=b-I+e,p1=M-N+e,s1=F-L+e,v1=g-_+e,o1=b-$+2*e,m1=M-J+2*e,L1=F-Z+2*e,_1=g-G+2*e,O1=b-q+3*e,X1=M-c1+3*e,Y1=F-r1+3*e,Z1=g-u1+3*e,K1=b-1+4*e,$1=M-1+4*e,J1=F-1+4*e,Q1=g-1+4*e,A1=i&255,b1=c&255,M1=l&255,g1=f&255,C1=.6-b*b-M*M-F*F-g*g;if(C1<0)t=0;else{var k1=d[A1+d[b1+d[M1+d[g1]]]]%32*4;C1*=C1,t=C1*C1*(y[k1]*b+y[k1+1]*M+y[k1+2]*F+y[k1+3]*g)}var S1=.6-n1*n1-p1*p1-s1*s1-v1*v1;if(S1<0)a=0;else{var B1=d[A1+I+d[b1+N+d[M1+L+d[g1+_]]]]%32*4;S1*=S1,a=S1*S1*(y[B1]*n1+y[B1+1]*p1+y[B1+2]*s1+y[B1+3]*v1)}var F1=.6-o1*o1-m1*m1-L1*L1-_1*_1;if(F1<0)r=0;else{var E1=d[A1+$+d[b1+J+d[M1+Z+d[g1+G]]]]%32*4;F1*=F1,r=F1*F1*(y[E1]*o1+y[E1+1]*m1+y[E1+2]*L1+y[E1+3]*_1)}var P1=.6-O1*O1-X1*X1-Y1*Y1-Z1*Z1;if(P1<0)s=0;else{var j1=d[A1+q+d[b1+c1+d[M1+r1+d[g1+u1]]]]%32*4;P1*=P1,s=P1*P1*(y[j1]*O1+y[j1+1]*X1+y[j1+2]*Y1+y[j1+3]*Z1)}var D1=.6-K1*K1-$1*$1-J1*J1-Q1*Q1;if(D1<0)n=0;else{var U1=d[A1+1+d[b1+1+d[M1+1+d[g1+1]]]]%32*4;D1*=D1,n=D1*D1*(y[U1]*K1+y[U1+1]*$1+y[U1+2]*J1+y[U1+3]*Q1)}return 27*(t+a+r+s+n)}};function E(v){var h,w=new Uint8Array(256);for(h=0;h<256;h++)w[h]=h;for(h=0;h<255;h++){var p=h+~~(v()*(256-h)),d=w[h];w[h]=w[p],w[p]=d}return w}W._buildPermutationTable=E;function H(){var v=0,h=0,w=0,p=1,d=C();v=d(" "),h=d(" "),w=d(" ");for(var y=0;y<arguments.length;y++)v-=d(arguments[y]),v<0&&(v+=1),h-=d(arguments[y]),h<0&&(h+=1),w-=d(arguments[y]),w<0&&(w+=1);return d=null,function(){var t=2091639*v+p*23283064365386963e-26;return v=h,h=w,w=t-(p=t|0)}}function C(){var v=4022871197;return function(h){h=h.toString();for(var w=0;w<h.length;w++){v+=h.charCodeAt(w);var p=.02519603282416938*v;v=p>>>0,p-=v,p*=v,v=p>>>0,p-=v,v+=p*4294967296}return(v>>>0)*23283064365386963e-26}}U.SimplexNoise=W,K.exports=W})()})(I1,I1.exports)),I1.exports}var j0=E0();const U0=F0(j0);z1.prototype.raycast=P0;a0.prototype.computeBoundsTree=D0;a0.prototype.disposeBoundsTree=T0;const j={displayBVH:!1,displayDepth:10,volume:{display:1,hideWhileGenerating:!1,alwaysShowDistance:!0,surfaceOnly:!1,distance:1,resolution:100,radius:4},displayClosestPoint:!0};let R1,O,d1,e1,o0,l1,t1,Q,a1,x1,R,h1,i1,f1,w1,N1=!1;function G0(){e1=new c0({antialias:!0}),e1.setPixelRatio(window.devicePixelRatio),e1.setSize(window.innerWidth,window.innerHeight),e1.setClearColor(1251612,1),e1.setAnimationLoop(H0),e1.shadowMap.enabled=!0,e1.shadowMap.type=x0,document.body.appendChild(e1.domElement),O=new f0,O.fog=new h0(2503224/2,10,45);const U=new u0(16777215,1.5);U.position.set(20,20,20),U.castShadow=!0,U.shadow.mapSize.set(2048,2048);const V=U.shadow.camera;V.left=V.bottom=-15,V.right=V.top=15,V.updateProjectionMatrix(),O.add(U),O.add(new p0(14743546,1.5));const X=50,Y=250,T=new v0(X,X,Y-1,Y-1),B=T.attributes.position,e=Math.floor(Math.random()*100),W=new U0(e);for(let d=0;d<Y*Y;d++){const y=B.getX(d)/15,t=B.getY(d)/15;B.setZ(d,W.noise2D(y,t)*3)}T.computeVertexNormals(),T.computeBoundsTree(),t1=new z1(T,new q1({color:16777215,metalness:.1,roughness:.9,side:r0})),t1.rotation.x=-Math.PI/2,t1.position.y=-3,t1.receiveShadow=!0,O.add(t1),d1=new m0(75,window.innerWidth/window.innerHeight,.1,50),d1.position.z=5,d1.far=100,d1.updateProjectionMatrix(),R1=new M0,document.body.appendChild(R1.dom);const E=new q1({roughness:.75,metalness:.1});Q=new n0,O.add(Q),a1=new z1(new y0(.5,.25,1,20,1),E),a1.castShadow=!0,a1.receiveShadow=!0,a1.geometry.computeBoundsTree(),a1.geometry.computeBoundingSphere(),Q.add(a1),o0=new C0(d1,e1.domElement),x1=new S0(d1,e1.domElement),x1.attach(Q),x1.addEventListener("dragging-changed",d=>{o0.enabled=!d.value,d.value||(N1=!0)}),x1.addEventListener("objectChange",d=>{N1=!0}),O.add(x1.getHelper());const H=new q1({flatShading:!0,color:15277667,metalness:0,roughness:.35,transparent:!0,depthWrite:!1,opacity:.15,premultipliedAlpha:!0,side:r0});R=new k0(100,H,!1,!1,1e6),R.isolation=0,R.autoUpdate=!1,h1=new n0,h1.scale.multiplyScalar(5),h1.add(R),O.add(h1),i1=new z1(new w0(.025,20,20),new z0({color:15277667})),i1.castShadow=!0,O.add(i1),f1=i1.clone(),f1.castShadow=!0,O.add(f1);const C=new z1(new A0,i1.material);C.castShadow=!0,C.position.z=.5,w1=new b0,w1.add(C),O.add(w1),O.updateMatrixWorld(!0);const v=new g0({width:300});v.add(j,"displayBVH").onChange(()=>t0()),v.add(j,"displayDepth").min(1).max(40).step(1).onChange(()=>t0());const h=v.addFolder("distanceVisualization");h.add(j.volume,"display",{hide:0,"distance to terrain":1,"distance to mesh":2}).onChange(()=>{y1=!0}),h.add(j.volume,"hideWhileGenerating"),h.add(j.volume,"alwaysShowDistance"),h.add(j.volume,"surfaceOnly").onChange(()=>y1=!0),h.add(j.volume,"distance").min(0).max(2).step(.01).onChange(()=>y1=!0),h.add(j.volume,"radius").min(1).max(20).onChange(()=>y1=!0),h.add(j.volume,"resolution",5,200,1).onChange(()=>y1=!0),h.open(),v.add(x1,"mode",["translate","rotate"]);const w=v.addFolder("Position");w.add(Q.position,"x").min(-5).max(5).step(.001).listen(),w.add(Q.position,"y").min(-5).max(5).step(.001).listen(),w.add(Q.position,"z").min(-5).max(5).step(.001).listen();const p=v.addFolder("Rotation");p.add(Q.rotation,"x").min(-Math.PI).max(Math.PI).step(.001).listen(),p.add(Q.rotation,"y").min(-Math.PI).max(Math.PI).step(.001).listen(),p.add(Q.rotation,"z").min(-Math.PI).max(Math.PI).step(.001).listen(),v.open(),i0(),window.addEventListener("resize",function(){d1.aspect=window.innerWidth/window.innerHeight,d1.updateProjectionMatrix(),e1.setSize(window.innerWidth,window.innerHeight)},!1),window.addEventListener("keydown",function(d){switch(d.key){case"w":x1.mode="translate";break;case"e":x1.mode="rotate";break}v.controllersRecursive().forEach(y=>y.updateDisplay())})}function t0(){l1&&!j.displayBVH&&(O.remove(l1),l1=null),!l1&&j.displayBVH&&(l1=new W0(t1),O.add(l1)),l1&&(l1.depth=j.displayDepth,l1.update())}function i0(K){Q.updateMatrixWorld();const U=new e0().copy(t1.matrixWorld).invert().multiply(Q.matrixWorld),V=j.volume.distance,X=V,Y=K?V:0,T={},B={},W=!!t1.geometry.boundsTree.closestPointToGeometry(a1.geometry,U,T,B,Y,X)&&T.distance<V;W&&(i1.position.copy(T.point),f1.position.copy(B.point).applyMatrix4(U),i1.position.applyMatrix4(t1.matrixWorld),f1.position.applyMatrix4(t1.matrixWorld),w1.position.copy(i1.position),w1.lookAt(f1.position),w1.scale.set(.01,.01,i1.position.distanceTo(f1.position))),a1.material.color.set(W?15277667:6710886),a1.material.emissive.set(15277667).multiplyScalar(W?.25:0);const E=W&&!K;w1.visible=E,i1.visible=E,f1.visible=E}function*V0(){if(j.volume.display==0)return;i0();const K=j.volume.display==2,U=new l0,V=j.volume.surfaceOnly,X=j.volume.resolution,Y=j.volume.distance,T=j.volume.radius;let B,e,W;K?(Q.add(h1),e=new e0().identity(),B=(a1.geometry.boundingSphere.radius+Y)*2,W=a1):(O.add(h1),B=(T+4*T/X)*2,e=new e0().copy(t1.matrixWorld).invert(),W=t1),h1.scale.set(B/2,B/2,B/2),h1.updateMatrixWorld(),R.init(X),R.updateMatrixWorld();const E=R.matrixWorld.getMaxScaleOnAxis(),H=-E,C=R.size,v=2*E/C,h=v/2;R.isolation=.5,R.position.x=1/C,R.position.y=1/C,R.position.z=1/C,R.reset();const w={};let p=0;for(let d=0;d<C;d++)for(let y=0;y<C;y++)for(let t=0;t<C;t++){if(U.x=H+h+y*v,U.y=H+h+d*v,U.z=H+h+t*v,K||V||U.length()<T&&!K){U.applyMatrix4(e);const a=!!W.geometry.boundsTree.closestPointToPoint(U,w,Y,Y),r=w.distance<Y;R.setCell(y,d,t,a&&r?0:1)}p++,yield p/(C*C*C)}R.blur(1)}let W1=null,y1=!0;function H0(){R1.begin(),N1&&(i0(!j.volume.alwaysShowDistance),N1=!1),y1&&(W1=V0(),y1=!1);let K=0;if(W1){let U=window.performance.now();for(;window.performance.now()-U<15;){const V=W1.next();if(K=V.value,V.done){W1=null;break}}R.update(),R.visible=!j.volume.hideWhileGenerating&&j.volume.display!=0}W1||(R.visible=!0),document.getElementById("loader").setAttribute("style",`width: ${K*100}%`),e1.render(O,d1),R1.end()}G0();t0();
//# sourceMappingURL=distancecast-mHhR7jn4.js.map
