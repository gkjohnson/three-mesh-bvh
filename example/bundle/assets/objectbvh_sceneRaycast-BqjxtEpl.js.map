{"version":3,"file":"objectbvh_sceneRaycast-BqjxtEpl.js","sources":["../../objectbvh_sceneRaycast.js"],"sourcesContent":["import * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min.js';\nimport Stats from 'stats.js';\nimport { AVERAGE, CENTER, BVHHelper, SAH } from 'three-mesh-bvh';\nimport { ObjectBVH, objectAcceleratedRaycast } from './src/bvh/ObjectBVH.js';\n\nconst params = {\n\t// Scene\n\tmode: 'batched',\n\tanimate: true,\n\n\t// BVH\n\tuseBVH: true,\n\tstrategy: CENTER,\n\tprecise: false,\n\tincludeInstances: true,\n\n\t// Visualization\n\tshowHelper: false,\n\thelperDepth: 15,\n\thelperParents: false,\n\n\t// Raycast\n\tfirstHitOnly: true,\n};\n\nlet renderer, scene, camera, controls, stats;\nlet container, bvhHelper;\nlet raycaster, mouse, highlightMesh;\nlet outputElement;\n\ninit();\nrebuild();\n\nfunction init() {\n\n\toutputElement = document.getElementById( 'output' );\n\n\t// Renderer\n\trenderer = new THREE.WebGLRenderer( { antialias: true } );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.setClearColor( 0x131619, 1 );\n\trenderer.setAnimationLoop( render );\n\tdocument.body.appendChild( renderer.domElement );\n\n\t// Scene\n\tscene = new THREE.Scene();\n\tscene.fog = new THREE.Fog( 0x131619, 0, 10 );\n\n\t// Lights\n\tconst light1 = new THREE.DirectionalLight( 0xffffff, 2.5 );\n\tlight1.position.set( 1, 2, 1 );\n\tconst light2 = new THREE.DirectionalLight( 0xffffff, 0.75 );\n\tlight2.position.set( - 1, - 2, - 1 );\n\tscene.add( light1, light2, new THREE.AmbientLight( 0xffffff, 0.75 ) );\n\n\t// Camera\n\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 200 );\n\tcamera.position.set( 18, 10, 0 );\n\n\t// Controls\n\tcontrols = new OrbitControls( camera, renderer.domElement );\n\tcontrols.enablePan = false;\n\tcontrols.enableDamping = true;\n\n\t// Container\n\tcontainer = new THREE.Group();\n\tscene.add( container );\n\n\t// Raycaster\n\traycaster = new THREE.Raycaster();\n\tmouse = new THREE.Vector2();\n\n\t// Highlight sphere\n\thighlightMesh = new THREE.Mesh(\n\t\tnew THREE.SphereGeometry( 0.1, 16, 16 ),\n\t\tnew THREE.MeshBasicMaterial( { color: 0xffff00, transparent: true, opacity: 0.75, fog: false } )\n\t);\n\thighlightMesh.visible = false;\n\tscene.add( highlightMesh );\n\n\t// Stats\n\tstats = new Stats();\n\tdocument.body.appendChild( stats.dom );\n\n\t// GUI\n\tsetupGUI();\n\n\t// Events\n\twindow.addEventListener( 'resize', () => {\n\n\t\tcamera.aspect = window.innerWidth / window.innerHeight;\n\t\tcamera.updateProjectionMatrix();\n\t\trenderer.setSize( window.innerWidth, window.innerHeight );\n\n\t} );\n\n\twindow.addEventListener( 'pointermove', e => {\n\n\t\tmouse.x = ( e.clientX / window.innerWidth ) * 2 - 1;\n\t\tmouse.y = - ( e.clientY / window.innerHeight ) * 2 + 1;\n\n\t} );\n\n}\n\nfunction setupGUI() {\n\n\tconst gui = new GUI();\n\n\tgui.add( params, 'mode', [ 'group', 'instanced', 'batched', 'mix' ] ).onChange( rebuild );\n\tgui.add( params, 'animate' );\n\n\tconst bvhFolder = gui.addFolder( 'BVH' );\n\tbvhFolder.add( params, 'useBVH' ).onChange( rebuildBVH );\n\tbvhFolder.add( params, 'strategy', { CENTER, AVERAGE, SAH } ).onChange( rebuildBVH );\n\tbvhFolder.add( params, 'precise' ).onChange( rebuildBVH );\n\tbvhFolder.add( params, 'includeInstances' ).onChange( rebuildBVH );\n\tbvhFolder.add( params, 'firstHitOnly' ).onChange( () => raycaster.firstHitOnly = params.firstHitOnly );\n\tbvhFolder.open();\n\n\tconst helperFolder = gui.addFolder( 'Helper' );\n\thelperFolder.add( params, 'showHelper' );\n\thelperFolder.add( params, 'helperDepth', 1, 20, 1 ).onChange( v => {\n\n\t\tif ( bvhHelper ) {\n\n\t\t\tbvhHelper.depth = v;\n\t\t\tbvhHelper.update();\n\n\t\t}\n\n\t} );\n\thelperFolder.add( params, 'helperParents' ).onChange( v => {\n\n\t\tif ( bvhHelper ) {\n\n\t\t\tbvhHelper.displayParents = v;\n\t\t\tbvhHelper.update();\n\n\t\t}\n\n\t} );\n\n}\n\nfunction createObjects() {\n\n\t// Clear container\n\tdisposeGroup( container );\n\n\tconst COUNT = 10000;\n\tconst geometries = [\n\t\tnew THREE.TorusGeometry( 0.25, 0.1, 30, 30 ),\n\t\tnew THREE.SphereGeometry( 0.25, 30, 30 ),\n\t];\n\tconst colors = [ 0xE91E63, 0x03A9F4, 0x4CAF50, 0xFFC107, 0x9C27B0 ].map( c => new THREE.Color( c ) );\n\n\t// Calculate counts per mode\n\tconst counts = { group: 0, instanced: 0, batched: 0 };\n\tswitch ( params.mode ) {\n\n\t\tcase 'group': counts.group = COUNT; break;\n\t\tcase 'instanced': counts.instanced = COUNT; break;\n\t\tcase 'batched': counts.batched = COUNT; break;\n\t\tcase 'mix':\n\t\t\tcounts.group = counts.instanced = counts.batched = Math.ceil( COUNT / 3 );\n\t\t\tbreak;\n\n\t}\n\n\t// Create group meshes\n\tif ( counts.group ) {\n\n\t\tconst materials = colors.map( c => new THREE.MeshStandardMaterial( { color: c } ) );\n\t\tfor ( let i = 0; i < counts.group; i ++ ) {\n\n\t\t\tconst mesh = new THREE.Mesh( geometries[ i % geometries.length ], materials[ i % materials.length ] );\n\t\t\trandomTransform( mesh.matrix ).decompose( mesh.position, mesh.quaternion, mesh.scale );\n\t\t\tcontainer.add( mesh );\n\n\t\t}\n\n\t}\n\n\t// Create instanced meshes\n\tif ( counts.instanced ) {\n\n\t\tgeometries.forEach( geometry => {\n\n\t\t\tconst count = Math.ceil( counts.instanced / geometries.length );\n\t\t\tconst mesh = new THREE.InstancedMesh( geometry, new THREE.MeshStandardMaterial(), count );\n\t\t\tconst matrix = new THREE.Matrix4();\n\n\t\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\t\tmesh.setMatrixAt( i, randomTransform( matrix ) );\n\t\t\t\tmesh.setColorAt( i, colors[ i % colors.length ] );\n\n\t\t\t}\n\n\t\t\tcontainer.add( mesh );\n\n\t\t} );\n\n\t}\n\n\t// Create batched mesh\n\tif ( counts.batched ) {\n\n\t\tconst maxVerts = geometries.reduce( ( sum, g ) => sum + g.attributes.position.count, 0 );\n\t\tconst maxIndices = geometries.reduce( ( sum, g ) => sum + ( g.index?.count || 0 ), 0 );\n\t\tconst mesh = new THREE.BatchedMesh( counts.batched, maxVerts, maxIndices, new THREE.MeshStandardMaterial() );\n\t\tconst geoIds = geometries.map( g => mesh.addGeometry( g ) );\n\t\tconst matrix = new THREE.Matrix4();\n\n\t\tfor ( let i = 0; i < counts.batched; i ++ ) {\n\n\t\t\tconst id = mesh.addInstance( geoIds[ i % geoIds.length ] );\n\t\t\tmesh.setMatrixAt( id, randomTransform( matrix ) );\n\t\t\tmesh.setColorAt( id, colors[ i % colors.length ] );\n\n\t\t}\n\n\t\tcontainer.add( mesh );\n\n\t}\n\n}\n\nfunction rebuildBVH() {\n\n\t// Cleanup\n\tif ( bvhHelper ) {\n\n\t\tbvhHelper.dispose();\n\t\tscene.remove( bvhHelper );\n\t\tbvhHelper = null;\n\n\t}\n\n\tcontainer.boundsTree = null;\n\n\t// Build BVH\n\tif ( params.useBVH ) {\n\n\t\tconsole.time( 'BVH Build' );\n\t\tcontainer.updateMatrixWorld();\n\t\tcontainer.boundsTree = new ObjectBVH( container, {\n\t\t\tstrategy: params.strategy,\n\t\t\tprecise: params.precise,\n\t\t\tincludeInstances: params.includeInstances,\n\t\t} );\n\t\tcontainer.raycast = objectAcceleratedRaycast;\n\t\tconsole.timeEnd( 'BVH Build' );\n\n\t\tbvhHelper = new BVHHelper( container, container.sceneBoundsTree, params.helperDepth );\n\t\tbvhHelper.displayParents = params.displayParents;\n\t\tbvhHelper.color.set( 0xffffff );\n\t\tbvhHelper.opacity = 0.6;\n\t\tscene.add( bvhHelper );\n\n\t}\n\n}\n\nfunction rebuild() {\n\n\tcreateObjects();\n\trebuildBVH();\n\n}\n\nfunction performRaycast() {\n\n\traycaster.setFromCamera( mouse, camera );\n\traycaster.firstHitOnly = params.firstHitOnly;\n\n\tconst start = performance.now();\n\tconst hits = raycaster.intersectObject( container, true );\n\toutputElement.innerText = `${ ( performance.now() - start ).toFixed( 3 ) }ms`;\n\n\thighlightMesh.visible = hits.length > 0;\n\tif ( hits.length ) highlightMesh.position.copy( hits[ 0 ].point );\n\n}\n\nfunction render() {\n\n\tstats.begin();\n\n\t// Update GUI settings\n\tif ( bvhHelper ) bvhHelper.visible = params.showHelper;\n\tif ( params.animate ) container.rotation.y += 0.0005;\n\tscene.fog.near = camera.position.length() - 7.5;\n\tscene.fog.far = camera.position.length() + 5;\n\n\tcontrols.update();\n\tperformRaycast();\n\n\trenderer.render( scene, camera );\n\tstats.end();\n\n}\n\n// Helpers\nfunction randomTransform( matrix ) {\n\n\tconst d = Math.cbrt( Math.random() );\n\tconst pos = new THREE.Vector3().randomDirection().multiplyScalar( 10 * d * d );\n\tconst rot = new THREE.Quaternion().setFromEuler( new THREE.Euler(\n\t\tMath.random() * Math.PI * 2,\n\t\tMath.random() * Math.PI * 2,\n\t\tMath.random() * Math.PI * 2\n\t) );\n\tconst scale = new THREE.Vector3().setScalar( 0.25 + Math.random() * 0.75 );\n\treturn matrix.compose( pos, rot, scale );\n\n}\n\nfunction disposeGroup( group ) {\n\n\twhile ( group.children.length ) {\n\n\t\tconst child = group.children[ 0 ];\n\t\tchild.geometry?.dispose();\n\t\tchild.material?.dispose();\n\t\tchild.dispose?.();\n\t\tgroup.remove( child );\n\n\t}\n\n}\n"],"names":["params","CENTER","renderer","scene","camera","controls","stats","container","bvhHelper","raycaster","mouse","highlightMesh","outputElement","init","rebuild","THREE.WebGLRenderer","render","THREE.Scene","THREE.Fog","light1","THREE.DirectionalLight","light2","THREE.AmbientLight","THREE.PerspectiveCamera","OrbitControls","THREE.Group","THREE.Raycaster","THREE.Vector2","THREE.Mesh","THREE.SphereGeometry","THREE.MeshBasicMaterial","Stats","setupGUI","e","gui","GUI","bvhFolder","rebuildBVH","AVERAGE","SAH","helperFolder","v","createObjects","disposeGroup","COUNT","geometries","THREE.TorusGeometry","colors","c","THREE.Color","counts","materials","THREE.MeshStandardMaterial","i","mesh","randomTransform","geometry","count","THREE.InstancedMesh","matrix","THREE.Matrix4","maxVerts","sum","g","maxIndices","_a","THREE.BatchedMesh","geoIds","id","ObjectBVH","objectAcceleratedRaycast","BVHHelper","performRaycast","start","hits","d","pos","THREE.Vector3","rot","THREE.Quaternion","THREE.Euler","scale","group","child","_b","_c"],"mappings":"wiBAOA,MAAMA,EAAS,CAEd,KAAM,UACN,QAAS,GAGT,OAAQ,GACR,SAAUC,EACV,QAAS,GACT,iBAAkB,GAGlB,WAAY,GACZ,YAAa,GACb,cAAe,GAGf,aAAc,EACf,EAEA,IAAIC,EAAUC,EAAOC,EAAQC,EAAUC,EACnCC,EAAWC,EACXC,EAAWC,EAAOC,EAClBC,EAEJC,GAAI,EACJC,EAAO,EAEP,SAASD,IAAO,CAEfD,EAAgB,SAAS,eAAgB,QAAQ,EAGjDV,EAAW,IAAIa,EAAqB,CAAE,UAAW,EAAI,CAAE,EACvDb,EAAS,cAAe,OAAO,gBAAgB,EAC/CA,EAAS,QAAS,OAAO,WAAY,OAAO,WAAW,EACvDA,EAAS,cAAe,QAAU,CAAC,EACnCA,EAAS,iBAAkBc,EAAM,EACjC,SAAS,KAAK,YAAad,EAAS,UAAU,EAG9CC,EAAQ,IAAIc,EACZd,EAAM,IAAM,IAAIe,EAAW,QAAU,EAAG,EAAE,EAG1C,MAAMC,EAAS,IAAIC,EAAwB,SAAU,GAAG,EACxDD,EAAO,SAAS,IAAK,EAAG,EAAG,CAAC,EAC5B,MAAME,EAAS,IAAID,EAAwB,SAAU,GAAI,EACzDC,EAAO,SAAS,IAAK,GAAK,GAAK,EAAG,EAClClB,EAAM,IAAKgB,EAAQE,EAAQ,IAAIC,EAAoB,SAAU,IAAM,EAGnElB,EAAS,IAAImB,EAAyB,GAAI,OAAO,WAAa,OAAO,YAAa,GAAK,GAAG,EAC1FnB,EAAO,SAAS,IAAK,GAAI,GAAI,CAAC,EAG9BC,EAAW,IAAImB,EAAepB,EAAQF,EAAS,UAAU,EACzDG,EAAS,UAAY,GACrBA,EAAS,cAAgB,GAGzBE,EAAY,IAAIkB,EAChBtB,EAAM,IAAKI,CAAS,EAGpBE,EAAY,IAAIiB,EAChBhB,EAAQ,IAAIiB,EAGZhB,EAAgB,IAAIiB,EACnB,IAAIC,EAAsB,GAAK,GAAI,EAAE,EACrC,IAAIC,EAAyB,CAAE,MAAO,SAAU,YAAa,GAAM,QAAS,IAAM,IAAK,EAAK,CAAE,CAChG,EACCnB,EAAc,QAAU,GACxBR,EAAM,IAAKQ,CAAa,EAGxBL,EAAQ,IAAIyB,EACZ,SAAS,KAAK,YAAazB,EAAM,GAAG,EAGpC0B,GAAQ,EAGR,OAAO,iBAAkB,SAAU,IAAM,CAExC5B,EAAO,OAAS,OAAO,WAAa,OAAO,YAC3CA,EAAO,uBAAsB,EAC7BF,EAAS,QAAS,OAAO,WAAY,OAAO,WAAW,CAExD,CAAC,EAED,OAAO,iBAAkB,cAAe+B,GAAK,CAE5CvB,EAAM,EAAMuB,EAAE,QAAU,OAAO,WAAe,EAAI,EAClDvB,EAAM,EAAI,EAAIuB,EAAE,QAAU,OAAO,aAAgB,EAAI,CAEtD,CAAC,CAEF,CAEA,SAASD,IAAW,CAEnB,MAAME,EAAM,IAAIC,EAEhBD,EAAI,IAAKlC,EAAQ,OAAQ,CAAE,QAAS,YAAa,UAAW,KAAK,GAAK,SAAUc,CAAO,EACvFoB,EAAI,IAAKlC,EAAQ,SAAS,EAE1B,MAAMoC,EAAYF,EAAI,UAAW,KAAK,EACtCE,EAAU,IAAKpC,EAAQ,QAAQ,EAAG,SAAUqC,CAAU,EACtDD,EAAU,IAAKpC,EAAQ,WAAY,CAAE,OAAAC,EAAQ,QAAAqC,GAAS,IAAAC,EAAG,CAAE,EAAG,SAAUF,CAAU,EAClFD,EAAU,IAAKpC,EAAQ,SAAS,EAAG,SAAUqC,CAAU,EACvDD,EAAU,IAAKpC,EAAQ,kBAAkB,EAAG,SAAUqC,CAAU,EAChED,EAAU,IAAKpC,EAAQ,cAAc,EAAG,SAAU,IAAMS,EAAU,aAAeT,EAAO,YAAY,EACpGoC,EAAU,KAAI,EAEd,MAAMI,EAAeN,EAAI,UAAW,QAAQ,EAC5CM,EAAa,IAAKxC,EAAQ,YAAY,EACtCwC,EAAa,IAAKxC,EAAQ,cAAe,EAAG,GAAI,CAAC,EAAG,SAAUyC,GAAK,CAE7DjC,IAEJA,EAAU,MAAQiC,EAClBjC,EAAU,OAAM,EAIlB,CAAC,EACDgC,EAAa,IAAKxC,EAAQ,eAAe,EAAG,SAAUyC,GAAK,CAErDjC,IAEJA,EAAU,eAAiBiC,EAC3BjC,EAAU,OAAM,EAIlB,CAAC,CAEF,CAEA,SAASkC,IAAgB,CAGxBC,GAAcpC,CAAS,EAEvB,MAAMqC,EAAQ,IACRC,EAAa,CAClB,IAAIC,EAAqB,IAAM,GAAK,GAAI,EAAE,EAC1C,IAAIjB,EAAsB,IAAM,GAAI,EAAE,CACxC,EACOkB,EAAS,CAAE,SAAU,OAAU,QAAU,SAAU,QAAQ,EAAG,IAAKC,GAAK,IAAIC,EAAaD,CAAC,CAAE,EAG5FE,EAAS,CAAE,MAAO,EAAG,UAAW,EAAG,QAAS,CAAC,EACnD,OAASlD,EAAO,KAAI,CAEnB,IAAK,QAASkD,EAAO,MAAQN,EAAO,MACpC,IAAK,YAAaM,EAAO,UAAYN,EAAO,MAC5C,IAAK,UAAWM,EAAO,QAAUN,EAAO,MACxC,IAAK,MACJM,EAAO,MAAQA,EAAO,UAAYA,EAAO,QAAU,KAAK,KAAMN,EAAQ,CAAC,EACvE,KAEH,CAGC,GAAKM,EAAO,MAAQ,CAEnB,MAAMC,EAAYJ,EAAO,IAAK,GAAK,IAAIK,EAA4B,CAAE,MAAO,CAAC,EAAI,EACjF,QAAUC,EAAI,EAAGA,EAAIH,EAAO,MAAOG,IAAO,CAEzC,MAAMC,EAAO,IAAI1B,EAAYiB,EAAYQ,EAAIR,EAAW,MAAM,EAAIM,EAAWE,EAAIF,EAAU,MAAM,CAAE,EACnGI,EAAiBD,EAAK,MAAM,EAAG,UAAWA,EAAK,SAAUA,EAAK,WAAYA,EAAK,KAAK,EACpF/C,EAAU,IAAK+C,CAAI,CAEpB,CAED,CAyBA,GAtBKJ,EAAO,WAEXL,EAAW,QAASW,GAAY,CAE/B,MAAMC,EAAQ,KAAK,KAAMP,EAAO,UAAYL,EAAW,MAAM,EACvDS,EAAO,IAAII,EAAqBF,EAAU,IAAIJ,EAA8BK,CAAK,EACjFE,EAAS,IAAIC,EAEnB,QAAUP,EAAI,EAAGA,EAAII,EAAOJ,IAE3BC,EAAK,YAAaD,EAAGE,EAAiBI,CAAM,CAAE,EAC9CL,EAAK,WAAYD,EAAGN,EAAQM,EAAIN,EAAO,OAAQ,EAIhDxC,EAAU,IAAK+C,CAAI,CAEpB,CAAC,EAKGJ,EAAO,QAAU,CAErB,MAAMW,EAAWhB,EAAW,OAAQ,CAAEiB,EAAKC,IAAOD,EAAMC,EAAE,WAAW,SAAS,MAAO,CAAC,EAChFC,EAAanB,EAAW,OAAQ,CAAEiB,EAAKC,IAAC,OAAM,OAAAD,KAAQG,EAAAF,EAAE,QAAF,YAAAE,EAAS,QAAS,IAAK,CAAC,EAC9EX,EAAO,IAAIY,EAAmBhB,EAAO,QAASW,EAAUG,EAAY,IAAIZ,CAA4B,EACpGe,EAAStB,EAAW,IAAKkB,GAAKT,EAAK,YAAaS,EAAG,EACnDJ,EAAS,IAAIC,EAEnB,QAAUP,EAAI,EAAGA,EAAIH,EAAO,QAASG,IAAO,CAE3C,MAAMe,EAAKd,EAAK,YAAaa,EAAQd,EAAIc,EAAO,OAAQ,EACxDb,EAAK,YAAac,EAAIb,EAAiBI,CAAM,CAAE,EAC/CL,EAAK,WAAYc,EAAIrB,EAAQM,EAAIN,EAAO,OAAQ,CAEjD,CAEAxC,EAAU,IAAK+C,CAAI,CAEpB,CAED,CAEA,SAASjB,GAAa,CAGhB7B,IAEJA,EAAU,QAAO,EACjBL,EAAM,OAAQK,CAAS,EACvBA,EAAY,MAIbD,EAAU,WAAa,KAGlBP,EAAO,SAEX,QAAQ,KAAM,WAAW,EACzBO,EAAU,kBAAiB,EAC3BA,EAAU,WAAa,IAAI8D,EAAW9D,EAAW,CAChD,SAAUP,EAAO,SACjB,QAASA,EAAO,QAChB,iBAAkBA,EAAO,gBAC5B,CAAG,EACDO,EAAU,QAAU+D,EACpB,QAAQ,QAAS,WAAW,EAE5B9D,EAAY,IAAI+D,GAAWhE,EAAWA,EAAU,gBAAiBP,EAAO,WAAW,EACnFQ,EAAU,eAAiBR,EAAO,eAClCQ,EAAU,MAAM,IAAK,QAAQ,EAC7BA,EAAU,QAAU,GACpBL,EAAM,IAAKK,CAAS,EAItB,CAEA,SAASM,GAAU,CAElB4B,GAAa,EACbL,EAAU,CAEX,CAEA,SAASmC,IAAiB,CAEzB/D,EAAU,cAAeC,EAAON,CAAM,EACtCK,EAAU,aAAeT,EAAO,aAEhC,MAAMyE,EAAQ,YAAY,IAAG,EACvBC,EAAOjE,EAAU,gBAAiBF,EAAW,EAAI,EACvDK,EAAc,UAAY,IAAM,YAAY,MAAQ6D,GAAQ,QAAS,CAAC,CAAE,KAExE9D,EAAc,QAAU+D,EAAK,OAAS,EACjCA,EAAK,QAAS/D,EAAc,SAAS,KAAM+D,EAAM,CAAC,EAAG,KAAK,CAEhE,CAEA,SAAS1D,IAAS,CAEjBV,EAAM,MAAK,EAGNE,IAAYA,EAAU,QAAUR,EAAO,YACvCA,EAAO,UAAUO,EAAU,SAAS,GAAK,MAC9CJ,EAAM,IAAI,KAAOC,EAAO,SAAS,OAAM,EAAK,IAC5CD,EAAM,IAAI,IAAMC,EAAO,SAAS,OAAM,EAAK,EAE3CC,EAAS,OAAM,EACfmE,GAAc,EAEdtE,EAAS,OAAQC,EAAOC,CAAM,EAC9BE,EAAM,IAAG,CAEV,CAGA,SAASiD,EAAiBI,EAAS,CAElC,MAAMgB,EAAI,KAAK,KAAM,KAAK,OAAM,CAAE,EAC5BC,EAAM,IAAIC,IAAgB,gBAAe,EAAG,eAAgB,GAAKF,EAAIA,CAAC,EACtEG,EAAM,IAAIC,IAAmB,aAAc,IAAIC,EACpD,KAAK,OAAM,EAAK,KAAK,GAAK,EAC1B,KAAK,OAAM,EAAK,KAAK,GAAK,EAC1B,KAAK,OAAM,EAAK,KAAK,GAAK,CAC5B,CAAE,EACKC,EAAQ,IAAIJ,IAAgB,UAAW,IAAO,KAAK,OAAM,EAAK,GAAI,EACxE,OAAOlB,EAAO,QAASiB,EAAKE,EAAKG,CAAK,CAEvC,CAEA,SAAStC,GAAcuC,EAAQ,WAE9B,KAAQA,EAAM,SAAS,QAAS,CAE/B,MAAMC,EAAQD,EAAM,SAAU,CAAC,GAC/BjB,EAAAkB,EAAM,WAAN,MAAAlB,EAAgB,WAChBmB,EAAAD,EAAM,WAAN,MAAAC,EAAgB,WAChBC,EAAAF,EAAM,UAAN,MAAAE,EAAA,KAAAF,GACAD,EAAM,OAAQC,CAAK,CAEpB,CAED"}